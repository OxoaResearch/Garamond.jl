<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Client/Server · Garamond.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Garamond.jl logo"/></a><h1>Garamond.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><a class="toctext" href="../features/">Feature list</a></li><li class="current"><a class="toctext" href>Client/Server</a><ul class="internal"><li><a class="toctext" href="#Command-line-utility-1">Command line utility</a></li><li><a class="toctext" href="#Server-mode-1">Server mode</a></li></ul></li><li><a class="toctext" href="../api/">API Reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Client/Server</a></li></ul><a class="edit-page" href="https://github.com/zgornel/Garamond.jl/blob/master/docs/src/clientserver.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Client/Server</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Running-Garamond-in-server/client-mode-1" href="#Running-Garamond-in-server/client-mode-1">Running Garamond in server/client mode</a></h1><p>Garamond is desinged as a <a href="http://catb.org/~esr/writings/taoup/html/ch11s06.html#id2958899">client-server architecture</a> in which the server receives queries, performs the search action and returns the results to a client that handles the interaction. The client can be either human or machine controlled.</p><h2><a class="nav-anchor" id="Command-line-utility-1" href="#Command-line-utility-1">Command line utility</a></h2><p>The main command line utility for Gramond is the script <code>garamond.jl</code> found in the root directory of the package. It is designed to be able to start the search server (i.e. server mode) and to send queries and receive results from the search server (i.e. client mode). The client mode serves testing purposes only and should not be used in production, it will be probably discontinued in the near future. A separate client (that just reads and writes to/from the socket) should be developed and readily available. To view the command line options for <code>garamond.jl</code>, run <code>./garamond.jl --help</code>:</p><pre><code class="language-none"> % ./garamond.jl --help
usage: garamond.jl [-d DATA-CONFIG] [-e ENGINE-CONFIG]
                   [--log-level LOG-LEVEL] [-l LOG] [-s SOCKET]
                   [-q QUERY] [--client] [--server] [-h]

optional arguments:
  -d, --data-config DATA-CONFIG
                        data configuration file
  -e, --engine-config ENGINE-CONFIG
                        search engine configuration file (default: &quot;&quot;)
  --log-level LOG-LEVEL
                        logging level (default: &quot;info&quot;)
  -l, --log LOG         logging stream (default: &quot;stdout&quot;)
  -s, --socket SOCKET   UNIX socket for data communication (default:
                        &quot;/tmp/garamond/sockets/socket1&quot;)
  -q, --query QUERY     query the search engine if in client mode
                        (default: &quot;&quot;)
  --client              client mode
  --server              server mode
  -h, --help            show this help message and exit</code></pre><h2><a class="nav-anchor" id="Server-mode-1" href="#Server-mode-1">Server mode</a></h2><p>In <em>server</em> mode, Garamond listens to a socket (i.e.<code>/tmp/garamond/sockets/socket1</code>) for incoming queries. Once the query is received, it is processed and the answer written back to same socket. The following example starts Garamond in server mode (indexes the data and connects to socket, displaying all messages):</p><pre><code class="language-none">$ ./garamond.jl --server -d ../extras_for_Garamond/data/Cornel/delimited/config_cornel_data_classic.json -s /tmp/garamond/sockets/socket1 --log-level debug
[ [2018-11-18 15:29:17][DEBUG][garamond.jl:35] ~ GARAMOND ~ v&quot;0.0.0&quot; commit: 90f1a17 (2018-11-20)
[ [2018-11-18 15:29:25][DEBUG][fsm.jl:41] Waiting for query...</code></pre><p>##Client mode</p><p>In <em>client</em> mode, the script sends the query to the server&#39;s socket and waits the search results on the same socket. Since it uses the whole package, client startup times are slow. View the notes for faster query alternatives. The following example performs a query using the server defined above (the socket is not specified as the server uses the <em>default</em> value):</p><pre><code class="language-none">% ./garamond.jl --client --q &quot;arthur c clarke&quot; --log-level debug
[ [2018-11-18 15:37:33][DEBUG][garamond.jl:35] ~ GARAMOND ~ v&quot;0.0.0&quot; commit: 90f1a17 (2018-11-20)
[ [2018-11-18 15:37:33][DEBUG][io.jl:42] &gt;&gt;&gt; Query sent.
[ [2018-11-18 15:37:36][DEBUG][io.jl:44] &lt;&lt;&lt; Search results received.
[{&quot;id&quot;:{&quot;id&quot;:&quot;biglib-classic&quot;},&quot;query_matches&quot;:{&quot;d&quot;:{&quot;0.5441896&quot;:[3],&quot;0.78605163&quot;:[1,2],&quot;0.64313316&quot;:[6,7],&quot;0.5895387&quot;:[4,5]}},&quot;needle_matches&quot;:{&quot;clarke&quot;:1.5272124,&quot;arthur&quot;:1.5272124,&quot;c&quot;:1.5272124},&quot;suggestions&quot;:{&quot;d&quot;:{}}},{&quot;id&quot;:{&quot;id&quot;:&quot;techlib-classic&quot;},&quot;query_matches&quot;:{&quot;d&quot;:{&quot;0.053899456&quot;:[1,5]}},&quot;needle_matches&quot;:{&quot;c&quot;:0.10779891},&quot;suggestions&quot;:{&quot;d&quot;:{}}}]</code></pre><footer><hr/><a class="previous" href="../features/"><span class="direction">Previous</span><span class="title">Feature list</span></a><a class="next" href="../api/"><span class="direction">Next</span><span class="title">API Reference</span></a></footer></article></body></html>
